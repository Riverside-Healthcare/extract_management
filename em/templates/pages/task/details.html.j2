{% extends "layout.html.j2" %}

{% block js %}
	{% assets "js_project_details" %}
		<script type="text/javascript" src="{{ ASSET_URL }}"></script>
	{% endassets %}
	{% assets "js_prism" %}
		<script type="text/javascript" src="{{ ASSET_URL }}" ></script>
	{% endassets %}
{% endblock %}

{% block css %}
	{% assets "css_project_details" %}
		<link type="text/css" rel="stylesheet" href="{{ ASSET_URL }}" />
	{% endassets %}
	{% assets "css_prism" %}
		<link type="text/css" rel="stylesheet" href="{{ ASSET_URL }}" />
	{% endassets %}
{% endblock %}

{% block body %}

{% if invalid == True %}
	<h1>Invalid task.</h1>
	<h2>Maybe try <a class="em-titleGrey" href="/task">all tasks</a>?</h2>
{% else %}
	<h1 class="em-title">{{ t.name }} {% if t.project %}(<a class="em-titleGrey" href="/project/{{t.project.id}}">{{ t.project.name }}</a>){% endif %}</h1>
	<h2>{% if r %} Next Run: {{ r }}{% endif %}</h2>
			{% include "pages/task/nav.html.j2" %}

	<div class="em-grid">
	    <span class="em-gridName">Last Status</span>
	    <span class="em-gridValue {% if t.status.id == 2 %} em-error {% elif t.status.id == 1%} em-running {% elif t.status.id == 4%} em-success {% endif %}">{{ t.status.name }}</span>
	    <span class="em-gridName">Last Run</span>
	    <span class="em-gridValue">{{ l }}</span>
	    <span class="em-gridName">Project</span>
	    <span class="em-gridValue">{% if t.project %}<a class="em-link" href="/project/{{t.project.id}}">{{ t.project.name }}</a>{% else %}Orphan :'({%endif %}</span>
	    {% if t.project %}
	    	<span class="em-gridName">Owner</span>
	    	<span class="em-gridValue"><a href="/project/user/{{t.project.owner_id}}" class="em-link">{{ t.project.project_owner.full_name }}</a></span>
	    {%endif%}
	</div>
	<h2>Data Source</h2>
	<div class="em-grid">
		<span class="em-gridName">Source Type</span>
		<span class="em-gridValue">{{ t.source_type.name }}</span>

		<!-- source database -->
		{% if t.source_type_id == 1 and t.source_database_id %}
			</div>
				<div class="em-code"><a class="em-link" href="/connection/{{t.source_database_conn.connection.id}}">{{t.source_database_conn.connection.name}} - {{ t.source_database_conn.name }}</a><br>{{ t.source_database_conn.connection_string|decrypt|database_pass }}</div>
			<div class="em-grid">
				<div class="em-gridName">Include Headers?</div>
				<div class="em-gridValue">{% if t.source_query_include_header==1 %}Yes{% else %}No{% endif %}</div>
		{% endif %}

		<!-- source SFTP -->
		{% if t.source_type_id == 3 and t.source_sftp_id %}
			<span class="em-gridName">Filename</span>
			<span class="em-gridValue">{{ t.source_sftp_file}}</span>
			<span class="em-gridName">Delimiter</span>
			<span class="em-gridValue">{% if t.source_sftp_ignore_delimiter == 1 %}Ignored{% else %}{{ t.source_sftp_delimiter }}{% endif %}</span>
			</div>
				<span class="em-gridName">SFTP Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.source_sftp_conn.connection.id}}">{{t.source_sftp_conn.connection.name}} - {{ t.source_sftp_conn.name }}</a><br>{{ t.source_sftp_conn.address }}:{{ t.source_sftp_conn.port or '22' }}<br>{{ t.source_sftp_conn.path|clean_path }}<br>user: {{ t.source_sftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.source_sftp_conn.password|decrypt }}" style="width:{{t.source_sftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.source_sftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">
			
			
		{% endif %}

		<!-- source FTP -->
		{% if t.source_type_id == 4 and t.source_ftp_id %}
			
			<span class="em-gridName">Filename</span>
			<span class="em-gridValue">{{ t.source_ftp_file}}</span>
			<span class="em-gridName">Delimiter</span>
			<span class="em-gridValue">{% if t.source_ftp_ignore_delimiter == 1 %}Ignored{% else %}{{ t.source_ftp_delimiter }}{% endif %}</span>

			</div>
			<span class="em-gridName">FTP Connection</span>
			<div class="em-code"><a class="em-link" href="/connection/{{t.source_ftp_conn.connection.id}}">{{t.source_ftp_conn.connection.name}} - {{ t.source_ftp_conn.name }}</a><br>{{ t.source_ftp_conn.path|clean_path }}<br>user: {{ t.source_ftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.source_ftp_conn.password|decrypt }}" style="width:{{t.source_ftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.source_ftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">

		
		{% endif %}

		<!-- source SMB -->
		{% if t.source_type_id == 2 and t.source_smb_id != None %}
			
			<span class="em-gridName">Filename</span>
			<span class="em-gridValue">{{ t.source_smb_file}}</span>
			
		
				<span class="em-gridName">Delimiter</span>
				<span class="em-gridValue">{% if t.source_smb_ignore_delimiter == 1 %}Ignored{% else %}{{ t.source_smb_delimiter }}{% endif %}</span>

		</div>
				<span class="em-gridName">SMB Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.source_smb_conn.connection.id}}">{{t.source_smb_conn.connection.name}} - {{ t.source_smb_conn.name }}</a>{{ t.source_smb_conn.server_name }} ({{t.source_smb_conn.server_ip }})<br>{{ t.source_smb_conn.share_name }}/{{t.source_smb_conn.path|clean_path}}<br>user: {{ t.source_smb_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.source_smb_conn.password|decrypt }}" style="width:{{t.source_smb_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.source_smb_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>

			<div class="em-grid">

		{% endif %}

		<!-- query source -->	
		{% if  t.query_type and t.source_type_id == 1 %}
			<span class="em-gridName">Source Query Type</span>
			<span class="em-gridValue">{{ t.query_type.name }}</span>
		{% endif %}

		{% if t.query_params and t.source_type_id == 1 %}
		</div>
			<span class="em-gridName">Query Parameters *note: will override any project params</span>
			<div class="em-code">{{ t.query_params }}</div>
			<div class="em-grid">
		{% endif %}

		<!-- database -->
		{% if  t.database  and t.source_type_id == 1 %}
			<span class="em-gridName">Source Database</span>
			<span class="em-gridValue"><a class="em-link" href="/data-source/{{t.database.id}}">{{ t.database.name }}</a></span>
		{% endif %}

		<!-- code from git -->
		{% if t.source_git  and t.source_type_id == 1 and t.source_query_type_id == 1 %}
			<span class="em-gridName">Git URL</span>
			<span class="em-gridValue"><a class="em-link" href="{{ t.source_git }}" target="_blank">{{ t.source_git }}</a></span>
			</div>
			<div class="em-ajaxContent" data-src="/task/{{t.id}}/git"><div class="loader"><img src="/static/img/loader.gif"></div></div>
			<div class="em-grid">
		{%endif %}

		<!-- code from url -->
		{% if t.source_url  and t.source_type_id == 1 and t.source_query_type_id == 3 %}
			<span class="em-gridName">Web URL</span>
			<span class="em-gridValue"><a class="em-link" href="{{ t.source_url }}" target="_blank">{{ t.source_url }}</a></span>
			</div>
			<div class="em-ajaxContent" data-src="/task/{{t.id}}/url"><div class="loader"><img src="/static/img/loader.gif"></div></div>
			<div class="em-grid">
		{%endif %}

		<!-- source SMB -->
		{% if t.source_type_id == 1 and t.source_query_type_id == 2 and t.query_smb_id %}
			
			<span class="em-gridName">Filename</span>
			<span class="em-gridValue">{{ t.query_smb_file}}</span>
			
			</div>
				<span class="em-gridName">SMB Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.query_smb_conn.connection.id}}">{{t.query_smb_conn.connection.name}} - {{ t.query_smb_conn.name }}</a><br>{{ t.query_smb_conn.server_name }} ({{t.query_smb_conn.server_ip }})<br>{{ t.query_smb_conn.share_name }}/{{t.query_smb_conn.path|clean_path}}<br>user: {{ t.query_smb_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.query_smb_conn.password|decrypt }}" style="width:{{t.query_smb_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.query_smb_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>

			<div class="em-grid">

		{% endif %}

		<!-- source SFTP -->
		{% if t.source_type_id == 1 and t.source_query_type_id == 5 and t.query_sftp_id %}
			<span class="em-gridName">Filename</span>
			<span class="em-gridValue">{{ t.query_sftp_file}}</span>
     		</div>
				<span class="em-gridName">SFTP Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.query_sftp_conn.connection.id}}">{{t.query_sftp_conn.connection.name}} - {{ t.query_sftp_conn.name }}</a><br>{{ t.query_sftp_conn.address }}:{{ t.query_sftp_conn.port or '22' }}<br>{{ t.query_sftp_conn.path|clean_path }}<br>user: {{ t.query_sftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.query_sftp_conn.password|decrypt }}" style="width:{{t.query_sftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.query_sftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">
			
			
		{% endif %}

		<!-- source FTP -->
		{% if t.source_type_id == 1 and t.source_query_type_id == 6 and t.query_ftp_id %}
			
			<span class="em-gridName">Filename</span>
			<span class="em-gridValue">{{ t.query_ftp_file}}</span>
			<span class="em-gridName">Delimiter</span>
			<span class="em-gridValue">{% if t.query_ftp_ignore_delimiter == 1 %}Ignored{% else %}{{ t.query_ftp_delimiter }}{% endif %}</span>

			</div>
			<span class="em-gridName">FTP Connection</span>
			<div class="em-code"><a class="em-link" href="/connection/{{t.query_ftp_conn.connection.id}}">{{t.query_ftp_conn.connection.name}} - {{ t.query_ftp_conn.name }}</a><br>{{ t.query_ftp_conn.path|clean_path }}<br>user: {{ t.query_ftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.query_ftp_conn.password|decrypt }}" style="width:{{t.query_ftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.query_ftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">

		
		{% endif %}
	

		
		<!-- hand query -->
		{% if t.source_code and t.source_type_id == 1 and t.source_query_type_id == 4 %}
			</div>
			<span class="em-gridName">Source Code</span>
			{% with code = t.source_code %}
				{% include "pages/task/code.html.j2" %}
			{% endwith %}
			<div class="em-grid">
		{% endif %}
		</div>


		{% if t.processing_type_id != 'none' and t.processing_type_id != None %}

			<h2>Data Processing</h2>

			<div class="em-grid">
				<span class="em-gridName">Script Location</span>
				<span class="em-gridValue">{{ t.processing_type.name }}</span>
			
		
			<!-- code from git -->
			{% if t.processing_git  and t.processing_type_id == 4 %}
				<span class="em-gridName">Git URL</span>
				<span class="em-gridValue"><a class="em-link" href="{{ t.processing_git }}" target="_blank">{{ t.processing_git }}</a></span>
				</div>
				<div class="em-ajaxContent" data-src="/task/{{t.id}}/processing_git"><div class="loader"><img src="/static/img/loader.gif"></div></div>
				<div class="em-grid">
			{%endif %}

			<!-- code from url -->
			{% if t.processing_url  and t.processing_type_id == 5 %}
				<span class="em-gridName">Web URL</span>
				<span class="em-gridValue"><a class="em-link" href="{{ t.processing_url }}" target="_blank">{{ t.processing_url }}</a></span>
				</div>
				<div class="em-ajaxContent" data-src="/task/{{t.id}}/processing_url"><div class="loader"><img src="/static/img/loader.gif"></div></div>
				<div class="em-grid">
			{%endif %}

			<!-- processing SMB -->
			{% if t.processing_type_id == 1 %}
				
				<span class="em-gridName">Filename</span>
				<span class="em-gridValue">{{ t.query_smb_file}}</span>
				
				</div>
					<span class="em-gridName">SMB Connection</span>
					<div class="em-code"><a class="em-link" href="/connection/{{t.query_smb_conn.connection.id}}">{{t.query_smb_conn.connection.name}} - {{ t.query_smb_conn.name }}</a><br>{{ t.query_smb_conn.server_name }} ({{t.query_smb_conn.server_ip }})<br>{{ t.query_smb_conn.share_name }}/{{t.query_smb_conn.path|clean_path}}<br>user: {{ t.query_smb_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.query_smb_conn.password|decrypt }}" style="width:{{t.query_smb_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.query_smb_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>

				<div class="em-grid">

			{% endif %}

			<!-- processing SFTP -->
			{% if t.processing_type_id == 2 %}
				<span class="em-gridName">Filename</span>
				<span class="em-gridValue">{{ t.query_sftp_file}}</span>
	     		</div>
					<span class="em-gridName">SFTP Connection</span>
					<div class="em-code"><a class="em-link" href="/connection/{{t.query_sftp_conn.connection.id}}">{{t.query_sftp_conn.connection.name}} - {{ t.query_sftp_conn.name }}</a><br>{{ t.query_sftp_conn.address }}:{{ t.query_sftp_conn.port or '22' }}<br>{{ t.query_sftp_conn.path|clean_path }}<br>user: {{ t.query_sftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.query_sftp_conn.password|decrypt }}" style="width:{{t.query_sftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.query_sftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
				<div class="em-grid">
				
				
			{% endif %}

			<!-- processing FTP -->
			{% if t.processing_type_id == 3 %}
				
				<span class="em-gridName">Filename</span>
				<span class="em-gridValue">{{ t.query_ftp_file}}</span>
				<span class="em-gridName">Delimiter</span>
				<span class="em-gridValue">{% if t.query_ftp_ignore_delimiter == 1 %}Ignored{% else %}{{ t.query_ftp_delimiter }}{% endif %}</span>

				</div>
				<span class="em-gridName">FTP Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.query_ftp_conn.connection.id}}">{{t.query_ftp_conn.connection.name}} - {{ t.query_ftp_conn.name }}</a><br>{{ t.query_ftp_conn.path|clean_path }}<br>user: {{ t.query_ftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.query_ftp_conn.password|decrypt }}" style="width:{{t.query_ftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.query_ftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
				<div class="em-grid">

			
			{% endif %}
		
		
			<!-- hand query -->
			{% if t.processing_code and t.processing_type_id == 6 %}
				</div>
				{% with code = t.processing_code %}
					{% include "pages/task/code.html.j2" %}
				{% endwith %}
				<div class="em-grid">
			{% endif %}

			{% if t.processing_command %}
				</div>
				<span class="em-gridName">Processing Command</span>
				<div class="em-code">{{ t.processing_command }}</div>
				<div class="em-grid">
			{% endif %}
			</div>

		{% endif %}

		<h2>Data Destination</h2>
		<h3>File Information</h3>
		<div class="em-grid">
		<!-- file names -->
			<span class="em-gridName">File Name</span>
			<span class="em-gridValue">{{ t.destination_file_name or 'None speficied.' }}</span>
			<span class="em-gridName">File Type</span>
			<span class="em-gridValue">{{ t.file_type.name  or 'None speficied.'}}</span>
			<span class="em-gridName">File Delimeter</span>
			<span class="em-gridValue">{% if t.destination_ignore_delimiter == 1 %}Ignored{% else %}"{{ t.destination_file_delimiter or ',' }}"{% endif %}</span>
			{% if t.destination_create_zip == 1 %}
				<span class="em-gridName">Save into a ZIP archive?</span>
				<span class="em-gridValue">Yes</span>
				<span class="em-gridName">ZIP archive name</span>
				<span class="em-gridValue">{{ t.destination_zip_name }}</span>
			{% endif %}
		
		<!-- sftp output -->
		{% if t.destination_sftp_id and t.destination_sftp %}
			</div>
				<h3>SFTP</h3>
				<div class="em-grid">
				<span class="em-gridName">SFTP Overwrite Existing Files?</span>
			<span class="em-gridValue">{% if t.destination_sftp_overwrite == 1 %}Yes{%else %}No{% endif %}</span>
		</div>
				<span class="em-gridName">SFTP Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.destination_sftp_conn.connection.id}}">{{t.destination_sftp_conn.connection.name}} - {{ t.destination_sftp_conn.name }}</a><br>{{ t.destination_sftp_conn.address }}:{{ t.destination_sftp_conn.port or '22' }}<br>{{ t.destination_sftp_conn.path|clean_path }}<br>user: {{ t.destination_sftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.destination_sftp_conn.password|decrypt }}" style="width:{{t.destination_sftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.destination_sftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">
			
		{% endif %}

		<!-- ftp output -->
		{% if t.destination_ftp_id and t.destination_ftp %}
			</div>
				<h3>FTP</h3>
				<div class="em-grid">

				<span class="em-gridName">FTP Overwrite Existing Files?</span>
				<span class="em-gridValue">{% if t.destination_ftp_overwrite == 1 %}Yes{%else %}No{% endif %}</span>
			</div>
				<span class="em-gridName">FTP Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.destination_ftp_conn.connection.id}}">{{t.destination_ftp_conn.connection.name}} - {{ t.destination_ftp_conn.name }}</a><br>{{ t.destination_ftp_conn.path|clean_path }}<br>user: {{ t.destination_ftp_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.destination_ftp_conn.password|decrypt }}" style="width:{{t.destination_ftp_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.destination_ftp_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">

		{% endif %}

		<!-- smb output -->
		{% if t.destination_smb_id and t.destination_smb %}
			</div>
				<h3>SMB</h3>
				<div class="em-grid">
					<span class="em-gridName">SMB Overwrite Existing Files?</span>
					<span class="em-gridValue">{% if t.destination_smb_overwrite == 1 %}Yes{%else %}No{% endif %}</span>
				</div>

				<span class="em-gridName">SMB Connection</span>
				<div class="em-code"><a class="em-link" href="/connection/{{t.destination_smb_conn.connection.id}}">{{t.destination_smb_conn.connection.name}} - {{ t.destination_smb_conn.name }}</a><br>{{ t.destination_smb_conn.server_name }} ({{t.destination_smb_conn.server_ip }})<br>{{ t.destination_smb_conn.share_name }}/{{t.destination_smb_conn.path|clean_path}}<br>user: {{ t.destination_smb_conn.username }}<br>pass: <input type="password" class="em-inputPlain" disabled="true" value="{{ t.destination_smb_conn.password|decrypt }}" style="width:{{t.destination_smb_conn.password|decrypt|length * 6}}px;cursor: text;"/><a class="em-inputPlainCopy" title="copy password" data-value="{{ t.destination_smb_conn.password|decrypt }}"><svg viewBox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"/></svg></a></div>
			<div class="em-grid">
			
				
		{% endif %}

		<!-- no saved file output -->
		{% if (not t.destination_sftp_id and t.destination_sftp != 1) and (not t.destination_smb_id and t.destination_smb != 1) and ( not t.destination_ftp_id and t.destination_ftp != 1) %}
			<span class="em-gridName">Connection</span>
			<span class="em-gridValue">No SFTP/FTP/SMB output.</span>
		{% endif %}
		
		
	</div>

	<!-- success emails -->
	{% if t.email_completion == 1 %}
		<h2>Success Email</h2>
		<div class="em-grid">
			<span class="em-gridName">Attach output file to email?</span>
			<span class="em-gridValue">{% if t.email_completion_file == 1 %}Yes{% else %}No{% endif %}</span>

			<span class="em-gridName">Include log information?</span>
			<span class="em-gridValue">{% if t.email_completion_log == 1 %}Yes{% else %}No{% endif %}</span>

			<span class="em-gridName">Email Recipients</span>
			<span class="em-gridValue">{{ t.email_completion_recipients or "None" }}</span>
		</div>
		{% if t.email_completion_message|length > 0 %}
		<div class="em-gridName">Email Message</div>
		<pre><code class="language-text">{{ t.email_completion_message }}</code></pre>
		{% endif %}
	{% endif %}
		

	<!-- error emails -->
	{% if t.email_error == 1 %}
		<h2>Error Email</h2>
		<div class="em-grid">
			<span class="em-gridName">Email Recipients</span>
			<span class="em-gridValue">{{ t.email_error_recipients or "None" }}</span>
		</div>
			{% if t.email_error_message|length > 0 %}
		<div class="em-gridName">Email Message</div>
		<pre><code class="language-text">{{ t.email_error_message }}</code></pre>
		{% endif %}
	{% endif %}

	<h2>Task Log</h2>
	<div class="em-ajaxTable" data-src="/task/{{t.id}}/log"><div class="loader-typing"><img src="/static/img/typing.gif"></div></div>

	<h2>Task Files</h2>
	<div class="em-ajaxTable" data-src="/task/{{t.id}}/file"><div class="loader-typing"><img src="/static/img/typing.gif"></div></div>

{% endif %}


{% endblock %}